<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wcc.wds.web.dao.CollectInstanceDao">
  <select id="selectAll" resultType="com.wcc.wds.web.model.CollectInstance">
    select * from wds_collect_task
  </select>

  <insert id="insert" parameterType="com.wcc.wds.web.model.CollectInstance">
    insert into wds_collect_task(instance_id,task_id,instance_status,start_time)
    values (#{instanceId},#{taskId},#{instanceStatus},#{startTime})
  </insert>

  <delete id="deleteById">
    delete from wds_collect_task where instance_id = #{instanceId}
  </delete>

  <update id="updateNotNullById">
    update wds_collect_task
    <set >
      <if test=" instanceStatus != null">
        instance_status = #{instanceStatus},
      </if>
      <if test="endTime != null">
        end_time = #{endTime},
      </if>
    </set>
    where instance_id = #{instanceId}
  </update>

  <select id="selectFail" resultType="com.wcc.wds.web.model.CollectInstance">
    select task_id from wds_collect_task where instance_status = 'failed'
  </select>


</mapper>